<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
<title>å’’è¯­é­”ç›’ (Prompt Fill Tool) V0.5.2</title>
<style>
    /* --- æ ¸å¿ƒæ ·å¼ --- */
    :root {
        --primary: #4f46e5;
        --primary-bg: #eef2ff;
        --border: #e5e7eb;
        --text-main: #1f2937;
        --text-sub: #6b7280;
        --bg-body: #f9fafb;
        --bg-white: #ffffff;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --radius: 12px;
    }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: var(--bg-body); color: var(--text-main); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
    
    /* å¸ƒå±€å®¹å™¨ */
    .app-container { display: flex; flex: 1; overflow: hidden; position: relative; }
    .sidebar { width: 300px; background: var(--bg-white); border-right: 1px solid var(--border); display: flex; flex-direction: column; z-index: 20; transition: transform 0.3s; }
    .main-area { flex: 1; display: flex; flex-direction: column; background: var(--bg-white); position: relative; overflow: hidden; }
    .config-panel { width: 320px; background: var(--bg-white); border-left: 1px solid var(--border); display: flex; flex-direction: column; z-index: 30; transition: transform 0.3s; }

    /* é€šç”¨ç»„ä»¶ */
    button { cursor: pointer; border: none; background: none; outline: none; transition: 0.2s; }
    button:active { transform: scale(0.96); }
    .btn-primary { background: var(--primary); color: white; padding: 10px 16px; border-radius: 8px; font-weight: 500; display: flex; align-items: center; justify-content: center; gap: 6px; }
    .btn-primary:hover { opacity: 0.9; }
    .btn-ghost { color: var(--text-sub); padding: 6px; border-radius: 6px; }
    .btn-ghost:hover { background: #f3f4f6; color: var(--text-main); }
    
    .input-box { width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 8px; font-size: 14px; outline: none; transition: 0.2s; }
    .input-box:focus { border-color: var(--primary); box-shadow: 0 0 0 3px var(--primary-bg); }

    /* é¡¶éƒ¨å·¥å…·æ  */
    .toolbar { height: 60px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; padding: 0 16px; background: var(--bg-white); flex-shrink: 0; }
    .toolbar-group { display: flex; gap: 8px; background: #f3f4f6; padding: 4px; border-radius: 8px; }
    .mode-btn { padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: 600; color: var(--text-sub); }
    .mode-btn.active { background: white; color: var(--primary); box-shadow: var(--shadow); }

    /* æ»šåŠ¨æ¡ */
    .scroll-y { overflow-y: auto; flex: 1; -webkit-overflow-scrolling: touch; }
    .scroll-y::-webkit-scrollbar { width: 5px; }
    .scroll-y::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 4px; }

    /* æ¨¡ç‰ˆåˆ—è¡¨ */
    .template-item { padding: 12px; margin: 8px 12px; border: 1px solid transparent; border-radius: var(--radius); cursor: pointer; display: flex; align-items: center; gap: 10px; transition: 0.2s; }
    .template-item:hover { background: #f9fafb; border-color: var(--border); }
    .template-item.active { background: var(--primary-bg); border-color: #c7d2fe; box-shadow: 0 2px 4px rgba(79, 70, 229, 0.05); }
    .template-icon { width: 32px; height: 32px; background: #e0e7ff; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--primary); font-size: 14px; font-weight: bold; flex-shrink: 0; }
    .template-info { flex: 1; min-width: 0; }
    .template-title { font-size: 14px; font-weight: 600; color: var(--text-main); margin-bottom: 2px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .template-desc { font-size: 11px; color: var(--text-sub); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

    /* å¡«ç©ºåŒºåŸŸ */
    .split-view { display: flex; height: 100%; }
    .editor-inputs { flex: 1; padding: 20px; background: #f9fafb; border-right: 1px solid var(--border); max-width: 450px; padding-bottom: 100px; }
    .editor-preview { flex: 1; padding: 40px; background: #f3f4f6; overflow-y: auto; display: none; } /* PCé»˜è®¤æ˜¾ç¤º */
    .preview-card { background: white; padding: 40px; border-radius: var(--radius); box-shadow: var(--shadow); min-height: 600px; white-space: pre-wrap; font-family: monospace; line-height: 1.8; font-size: 14px; color: #374151; }

    /* è¾“å…¥å¡ç‰‡ */
    .var-group { margin-bottom: 24px; animation: slideIn 0.3s ease; }
    .var-group-title { font-size: 11px; font-weight: 800; color: #9ca3af; margin-bottom: 8px; display: flex; align-items: center; gap: 6px; text-transform: uppercase; letter-spacing: 0.5px; }
    .var-input-card { background: white; border: 1px solid var(--border); border-radius: 8px; padding: 10px 12px; margin-bottom: 10px; position: relative; display: flex; flex-direction: column; transition: 0.2s; box-shadow: 0 1px 2px rgba(0,0,0,0.02); }
    .var-input-card:focus-within { border-color: var(--primary); box-shadow: 0 4px 12px rgba(79, 70, 229, 0.1); transform: translateY(-1px); z-index: 5; }
    .var-label { font-size: 10px; color: #6b7280; font-weight: 700; margin-bottom: 4px; display: flex; justify-content: space-between; }
    .var-input { border: none; outline: none; font-size: 14px; width: 100%; color: var(--text-main); background: transparent; padding-right: 24px; }
    .var-select-btn { position: absolute; right: 8px; bottom: 8px; color: #9ca3af; padding: 4px; cursor: pointer; }
    .var-select-btn:hover { color: var(--primary); }
    .dropdown-menu { position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid var(--border); border-radius: 8px; margin-top: 4px; max-height: 240px; overflow-y: auto; z-index: 100; box-shadow: 0 10px 25px -5px rgba(0,0,0,0.1); display: none; }
    .dropdown-item { padding: 10px 12px; font-size: 13px; cursor: pointer; border-bottom: 1px solid #f3f4f6; color: #4b5563; }
    .dropdown-item:hover { background: var(--primary-bg); color: var(--primary); }

    /* é«˜äº®æ–‡æœ¬ */
    .hl-var { display: inline-block; margin: 0 2px; padding: 0 4px; border-radius: 4px; font-weight: bold; border-bottom: 2px solid; }
    .hl-filled { background: #e0e7ff; color: #4338ca; border-color: #6366f1; }
    .hl-empty { background: #fef3c7; color: #b45309; border-color: #f59e0b; border-style: dashed; }

    /* åº•éƒ¨å¯¼èˆª (ç§»åŠ¨ç«¯) */
    .bottom-nav { display: none; height: 60px; background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border-top: 1px solid var(--border); position: fixed; bottom: 0; left: 0; right: 0; justify-content: space-around; align-items: center; z-index: 50; padding-bottom: env(safe-area-inset-bottom); }
    .nav-btn { display: flex; flex-direction: column; align-items: center; gap: 4px; color: #9ca3af; font-size: 10px; font-weight: 500; width: 100%; }
    .nav-btn.active { color: var(--primary); }

    /* ç§»åŠ¨ç«¯é¢„è§ˆå¡ç‰‡ */
    .mobile-preview-widget { display: none; background: white; border: 1px solid #e0e7ff; border-radius: var(--radius); padding: 12px; margin-bottom: 16px; font-size: 12px; color: #4b5563; max-height: 120px; overflow-y: auto; font-family: monospace; line-height: 1.6; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }

    /* åŠ¨ç”» */
    @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* å“åº”å¼ */
    @media (min-width: 1024px) {
        .editor-preview { display: block; }
        .config-panel { position: relative; transform: none !important; }
        .sidebar { position: relative; transform: none !important; }
        .mobile-only { display: none !important; }
    }
    @media (max-width: 1023px) {
        .sidebar { position: fixed; top: 0; bottom: 60px; left: 0; transform: translateX(-100%); width: 100%; z-index: 40; }
        .config-panel { position: fixed; top: 0; bottom: 60px; right: 0; transform: translateX(100%); width: 100%; z-index: 40; }
        .sidebar.open { transform: translateX(0); }
        .config-panel.open { transform: translateX(0); }
        .bottom-nav { display: flex; }
        .editor-inputs { max-width: 100%; border-right: none; }
        .mobile-preview-widget { display: block; }
        .pc-only { display: none !important; }
        .app-container { padding-bottom: 60px; } /* ä¸ºåº•éƒ¨å¯¼èˆªç•™ç©º */
    }
</style>
<!-- HTML2Canvas (å”¯ä¸€å¤–éƒ¨è„šæœ¬) -->
<script src="https://cdn.staticfile.net/html2canvas/1.4.1/html2canvas.min.js" onerror="console.warn('Screenshot lib failed to load')"></script>
</head>
<body>

<div class="app-container">
    
    <!-- 1. å·¦ä¾§ï¼šæ¨¡ç‰ˆç®¡ç† (Template Management) -->
    <div id="sidebar" class="sidebar">
        <div class="toolbar" style="justify-content: flex-start; gap: 10px;">
            <div style="font-weight: 800; font-size: 18px; color: var(--primary);">å’’è¯­é­”ç›’</div>
            <div style="font-size: 10px; background: var(--primary-bg); color: var(--primary); padding: 2px 6px; border-radius: 4px; font-weight: bold;">V0.5.2</div>
        </div>
        <div style="padding: 10px 16px 5px; font-size: 11px; font-weight: 700; color: #9ca3af; text-transform: uppercase;">æˆ‘çš„æ¨¡ç‰ˆ</div>
        <div id="template-list" class="scroll-y" style="padding: 0 8px;">
            <!-- æ¨¡ç‰ˆåˆ—è¡¨ç”± JS ç”Ÿæˆ -->
        </div>
        <div style="padding: 16px; border-top: 1px solid var(--border);">
            <button class="btn-primary" style="width: 100%;" onclick="createNewTemplate()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                æ–°å»ºæ¨¡ç‰ˆ
            </button>
        </div>
    </div>

    <!-- 2. ä¸­é—´ï¼šEditor (ç¼–è¾‘/å¡«ç©º) -->
    <div class="main-area">
        <div class="toolbar">
            <div class="toolbar-group">
                <button class="mode-btn active" id="btn-mode-fill" onclick="switchMode('fill')">äº¤äº’å¡«ç©º</button>
                <button class="mode-btn" id="btn-mode-code" onclick="switchMode('code')">æºç ç¼–è¾‘</button>
            </div>
            <div style="display: flex; gap: 8px;">
                <button class="btn-ghost pc-only" onclick="toggleConfig()" title="è¯åº“é…ç½®">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path></svg>
                </button>
                <button class="btn-ghost pc-only" onclick="exportImage()" title="ä¿å­˜é•¿å›¾">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>
                </button>
                <button class="btn-primary" style="padding: 6px 12px; font-size: 12px;" onclick="copyResult()">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    å¤åˆ¶ç»“æœ
                </button>
            </div>
        </div>

        <!-- å¡«ç©ºæ¨¡å¼è§†å›¾ -->
        <div id="view-fill" class="split-view">
            <div class="editor-inputs scroll-y">
                <!-- ç§»åŠ¨ç«¯å°é¢„è§ˆ -->
                <div class="mobile-preview-widget" id="mobile-preview-text"></div>
                <!-- åŠ¨æ€è¾“å…¥æ¡† -->
                <div id="input-container"></div>
                <div id="empty-state" style="text-align: center; color: #9ca3af; padding: 40px; font-size: 12px; display: none;">
                    å½“å‰æ¨¡ç‰ˆæ²¡æœ‰æ£€æµ‹åˆ°å˜é‡ã€‚<br>è¯·åˆ‡æ¢åˆ°â€œæºç ç¼–è¾‘â€æ¨¡å¼æ·»åŠ  {{variable}}ã€‚
                </div>
            </div>
            
            <div class="editor-preview">
                <div id="preview-card" class="preview-card"></div>
                <div style="margin-top: 20px; color: #d1d5db; font-size: 12px; display: flex; justify-content: space-between;">
                    <span>PROMPT FILL TOOL</span>
                    <span>GENERATED BY AI</span>
                </div>
            </div>
        </div>

        <!-- æºç æ¨¡å¼è§†å›¾ -->
        <div id="view-code" class="split-view" style="display: none;">
            <div style="display: flex; flex-direction: column; width: 100%; height: 100%;">
                <input id="template-title-input" type="text" placeholder="æ¨¡ç‰ˆæ ‡é¢˜" style="padding: 16px 24px; font-size: 16px; font-weight: bold; border: none; border-bottom: 1px solid var(--border); outline: none;">
                <textarea id="template-content-input" style="flex: 1; padding: 24px; border: none; outline: none; resize: none; font-family: monospace; font-size: 14px; line-height: 1.6; background: #f9fafb;" placeholder="åœ¨æ­¤è¾“å…¥ Prompt å†…å®¹..."></textarea>
            </div>
        </div>
    </div>

    <!-- 3. å³ä¾§ï¼šè¯åº“é…ç½® -->
    <div id="config-panel" class="config-panel">
        <div class="toolbar">
            <div style="font-weight: 700;">è¯åº“é…ç½®</div>
            <button class="btn-ghost mobile-only" onclick="closeAllPanels()">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
        </div>
        <div class="scroll-y" style="padding: 16px;">
            <div style="margin-bottom: 16px; display: flex; gap: 8px; flex-wrap: wrap;" id="config-keys"></div>
            <div style="background: #f9fafb; border: 1px solid var(--border); border-radius: 8px; padding: 12px;">
                <div style="font-size: 12px; font-weight: 700; color: #6b7280; margin-bottom: 8px; text-transform: uppercase;" id="current-config-key">ROLE</div>
                <div style="display: flex; gap: 8px; margin-bottom: 12px;">
                    <input id="new-option-input" type="text" placeholder="æ–°å¢é€‰é¡¹..." style="flex: 1; padding: 6px 10px; border: 1px solid var(--border); border-radius: 6px; font-size: 12px; outline: none;">
                    <button class="btn-primary" style="padding: 6px 10px;" onclick="addOption()">+</button>
                </div>
                <div id="option-list" style="max-height: 300px; overflow-y: auto;"></div>
            </div>
        </div>
    </div>

</div>

<!-- åº•éƒ¨å¯¼èˆª (ç§»åŠ¨ç«¯) -->
<div class="bottom-nav">
    <button class="nav-btn" onclick="openPanel('sidebar')" id="nav-templates">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg>
        æ¨¡ç‰ˆç®¡ç†
    </button>
    <button class="nav-btn active" onclick="openPanel('main')" id="nav-fill">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path></svg>
        Editor
    </button>
    <button class="nav-btn" onclick="openPanel('config')" id="nav-config">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="5" rx="9" ry="3"></ellipse><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"></path><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path></svg>
        è¯åº“é…ç½®
    </button>
</div>

<script>
    // --- æ ¸å¿ƒé€»è¾‘ (Vanilla JS) ---

    // 1. æ•°æ®é¢„è®¾ (åŒæ­¥è‡ªåŸç«™ https://promptfill.tanshilong.com)
    const DEFAULT_TEMPLATES = [
        { 
            id: 't1', 
            title: 'è§’è‰²æ¦‚å¿µåˆ†è§£å›¾', 
            icon: 'ğŸ‘¤',
            content: `Role (è§’è‰²è®¾å®š)\nä½ æ˜¯ä¸€ä½é¡¶å°–çš„ {{role}} ï¼Œæ“…é•¿åˆ¶ä½œè¯¦å°½çš„è§’è‰²è®¾å®šå›¾ï¼ˆCharacter Sheetï¼‰ã€‚ä½ å…·å¤‡â€œåƒç´ çº§æ‹†è§£â€çš„èƒ½åŠ›ï¼Œèƒ½å¤Ÿé€è§†è§’è‰²çš„ç©¿ç€å±‚çº§ã€æ•æ‰å¾®è¡¨æƒ…å˜åŒ–ï¼Œå¹¶å°†ä¸å…¶ç›¸å…³çš„ç‰©å“è¿›è¡Œå…·è±¡åŒ–è¿˜åŸã€‚ä½ ç‰¹åˆ«æ“…é•¿é€šè¿‡ {{subject}} çš„ç§å¯†ç‰©å“ã€éšèº«ç‰©ä»¶å’Œç”Ÿæ´»ç»†èŠ‚æ¥ä¾§é¢ä¸°æ»¡äººç‰©æ€§æ ¼ä¸èƒŒæ™¯æ•…äº‹ã€‚\n\nTask (ä»»åŠ¡ç›®æ ‡)\næ ¹æ®ç”¨æˆ·ä¸Šä¼ æˆ–æè¿°çš„ä¸»ä½“å½¢è±¡ï¼Œç”Ÿæˆä¸€å¼ â€œå…¨æ™¯å¼è§’è‰²æ·±åº¦æ¦‚å¿µåˆ†è§£å›¾â€ã€‚è¯¥å›¾ç‰‡å¿…é¡»åŒ…å« {{layout_focus}} ï¼Œå¹¶åœ¨å…¶å‘¨å›´ç¯ç»•å±•ç¤ºè¯¥äººç‰©çš„æœè£…åˆ†å±‚ã€ä¸åŒè¡¨æƒ…ã€æ ¸å¿ƒé“å…·ã€æè´¨ç‰¹å†™ï¼Œä»¥åŠæå…·ç”Ÿæ´»æ°”æ¯çš„ç§å¯†ä¸éšèº«ç‰©å“å±•ç¤ºã€‚\n\nVisual Guidelines (è§†è§‰è§„èŒƒ)\n1. æ„å›¾å¸ƒå±€(Layout):\nâ€¢ä¸­å¿ƒä½(Center): æ”¾ç½®è§’è‰²çš„ {{layout_focus}} ï¼Œä½œä¸ºè§†è§‰é”šç‚¹ã€‚\nâ€¢ç¯ç»•ä½(Surroundings): åœ¨ä¸­å¿ƒäººç‰©å››å‘¨ç©ºç™½å¤„ï¼Œæœ‰åºæ’åˆ—æ‹†è§£åçš„å…ƒç´ ã€‚\nâ€¢è§†è§‰å¼•å¯¼(Connectors): ä½¿ç”¨ {{connectors}} ï¼Œå°†å‘¨è¾¹çš„æ‹†è§£ç‰©å“ä¸ä¸­å¿ƒäººç‰©çš„å¯¹åº”éƒ¨ä½æˆ–æ‰€å±åŒºåŸŸè¿æ¥èµ·æ¥ã€‚\n\n2. æ‹†è§£å†…å®¹(Deconstruction Details):\nâ€¢æœè£…åˆ†å±‚(Clothing Layers): å°†è§’è‰²çš„æœè£…æ‹†åˆ†ä¸ºå•å“å±•ç¤ºï¼Œä¾‹å¦‚ï¼š {{clothing}}\nâ€¢ç§å¯†å†…ç€æ‹†è§£: ç‹¬ç«‹å±•ç¤ºè§’è‰²çš„å†…å±‚è¡£ç‰©ï¼Œé‡ç‚¹çªå‡ºè®¾è®¡æ„Ÿä¸æè´¨ã€‚ä¾‹å¦‚ï¼š {{underwear_style}} ï¼ˆå±•ç¤ºç»†èŠ‚ä¸å‰ªè£ï¼‰ã€‚\nâ€¢è¡¨æƒ…é›†(Expression Sheet): åœ¨è§’è½ç»˜åˆ¶3-4 ä¸ªä¸åŒçš„å¤´éƒ¨ç‰¹å†™ï¼Œå±•ç¤ºä¸åŒçš„æƒ…ç»ªï¼Œå¦‚ï¼š {{expressions}} ã€‚\nâ€¢æè´¨ç‰¹å†™(Texture & Zoom): é€‰å–å…³é”®éƒ¨ä½è¿›è¡Œæ”¾å¤§ç‰¹å†™ã€‚ä¾‹å¦‚ï¼š {{texture_zoom}} ï¼Œå¢åŠ å¯¹å°ç‰©ä»¶æè´¨çš„æç»˜ã€‚\nâ€¢åŠ¨ä½œ: ç»˜åˆ¶ç‰¹æ®Šçš„åŠ¨ä½œå’Œè¡¨æƒ…ï¼Œä¾‹å¦‚ï¼š {{action_detail}} ï¼Œå¢åŠ åŠ¨ä½œçš„æ·±åº¦åˆ»ç”»ã€‚\nâ€¢ç‰¹æ®Šè§†è§’: ç»˜åˆ¶ä»æŸç§ç‰¹æ®Šåœºæ™¯ä¸‹æ‹æ‘„çš„ç‰¹æ®Šè§†è§’ï¼Œä¾‹å¦‚ï¼š {{special_view}}\nâ€¢å…³è”ç‰©å“(Related Items):\nâ€¢éšèº«åŒ…è¢‹ä¸å†…å®¹ç‰©: ç»˜åˆ¶ {{bag_content}} ï¼Œå¹¶å°†å…¶â€œæ‰“å¼€â€ï¼Œå±•ç¤ºæ•£è½åœ¨æ—çš„ç‰©å“ã€‚\nâ€¢ç¾å¦†ä¸æŠ¤ç†: å±•ç¤º {{cosmetics}} ã€‚\nâ€¢ç§å¯†ç”Ÿæ´»ç‰©ä»¶: å…·è±¡åŒ–è§’è‰²éšè—é¢çš„ç‰©å“ã€‚æ ¹æ®è§’è‰²æ€§æ ¼å¯èƒ½åŒ…æ‹¬ï¼š {{private_items}} ï¼Œéœ€ä»¥ä¸€ç§è®¾è®¡å›¾çš„å®¢è§‚è§†è§’å‘ˆç°ã€‚\n\n3. é£æ ¼ä¸æ³¨é‡Š(Style & Annotations):\nâ€¢ç”»é£: {{art_style}} ï¼Œçº¿æ¡å¹²å‡€åˆ©è½ã€‚\nâ€¢èƒŒæ™¯: {{background_style}} ï¼Œè¥é€ è®¾è®¡æ‰‹ç¨¿çš„æ°›å›´ã€‚\nâ€¢ç¯å…‰: {{lighting}}` 
        },
        { 
            id: 't2', 
            title: '3x3 æ‘„å½±ç½‘æ ¼', 
            icon: 'ğŸ“¸',
            content: `Create a 3x3 photography grid showing different angles and details of {{subject}}.\n\nSettings:\nâ€¢ Role: {{role}}\nâ€¢ Lens: {{lens_param}}\nâ€¢ Lighting: {{lighting}}\nâ€¢ Art Style: {{art_style}}\n\nGrid Content:\n1. Top Left: Close-up of face, {{expressions}}\n2. Top Center: Full body shot, {{grid_pose}}\n3. Top Right: Detail of {{clothing}}\n4. Center Left: Side profile\n5. Center: Main action shot, {{action_pose}}\n6. Center Right: Back view\n7. Bottom Left: Accessory detail, {{bag_content}}\n8. Bottom Center: Footwear/Shoes\n9. Bottom Right: Artistic blur or {{special_view}}` 
        },
        {
            id: 't3',
            title: 'æ—¶å°šæƒ…ç»ªæ¿æ’ç”»',
            icon: 'ğŸ¨',
            content: `Create a Fashion Moodboard Illustration for {{subject}}.\n\nCore Elements:\nâ€¢ Main Outfit: {{clothing}}\nâ€¢ Deconstruction: {{fashion_deconstruct}}\nâ€¢ Under layer: {{underwear_style}}\n\nVibe & Style:\nâ€¢ Art Style: {{art_style}}\nâ€¢ Background: {{background_style}}\nâ€¢ Lighting: {{lighting}}\n\nAccessories:\nâ€¢ Bag content: {{bag_content}}\nâ€¢ Cosmetics: {{cosmetics}}\nâ€¢ Decor: {{sticker_decor}}`
        },
        {
            id: 't4',
            title: 'äººç‰©è¶£å‘³åˆå½±',
            icon: 'ğŸ‘¯â€â™€ï¸',
            content: `Draw a fun group photo featuring {{subject}} and {{character_companion}}.\n\nInteraction:\nâ€¢ Pose: {{action_pose}}\nâ€¢ Expressions: {{expressions}}\nâ€¢ Toy Companion: {{toy_companion}}\n\nScene:\nâ€¢ Location: {{background_scene}}\nâ€¢ Lighting: {{lighting}}\nâ€¢ Camera Angle: {{camera_angle}}\n\nStyle:\nâ€¢ Art Style: {{art_style}}\nâ€¢ Stickers: {{sticker_core}}`
        }
    ];
    
    // åŒæ­¥åŸç«™è¯åº“æ•°æ®
    const DEFAULT_OPTIONS = {
        // Character
        role: ["æ¸¸æˆä¸åŠ¨æ¼«æ¦‚å¿µç¾æœ¯è®¾è®¡å¤§å¸ˆ", "èµ„æ·±æ—¶å°šæ‘„å½±å¸ˆ", "ç”µå½±åˆ†é•œå¸ˆ", "äººè®¾ç”»å¸ˆ"],
        subject: ["å¥³æ€§è§’è‰²", "èµ›åšæœ‹å…‹é»‘å®¢", "å¥‡å¹»ç²¾çµæ¸¸ä¾ ", "ç°ä»£éƒ½å¸‚ç™½é¢†", "æœºç”²é©¾é©¶å‘˜"],
        character_companion: ["ä¸€åªè‚¥çŒ«", "ç«¥å¹´çš„è‡ªå·±", "å®¿æ•Œ", "å…¨æ¯æŠ•å½±AI"],
        expressions: ["ç–¯ç‹‚ã€ç—…å¨‡ã€ç‹‚å–œ", "å†·æ¼ ã€è½»è”‘ã€æ— è§†", "ç¾æ¶©ã€è„¸çº¢ã€èº²é—ª", "è‡ªä¿¡ã€å¼ æ‰¬ã€å¤§ç¬‘"],
        
        // Action
        grid_pose: ["ç«™ç«‹ã€åå§¿ã€åŠ¨æ€è·‘è·³", "æˆ˜æ–—å§¿æ€å±•ç¤º", "æ—¥å¸¸ä¼‘é—²åŠ¨ä½œ"],
        action_detail: ["å¸¦ç€é¡¹åœˆçš„çˆ¬è¡Œ", "æ‹”å‰‘æˆ˜æ–—å§¿æ€", "ä¼˜é›…çš„ä¸‹åˆèŒ¶æ—¶å…‰", "æ•´ç†é¢†å¸¦"],
        action_pose: ["èƒŒé èƒŒæˆ˜æ–—", "äº’ç›¸å–‚é£Ÿ", "æ‘¸å¤´æ€", "å¯¹å³™"],
        
        // Visuals
        layout_focus: ["å…¨èº«ç«‹ç»˜", "åŠèº«åƒ", "ç‰¹å†™é•œå¤´", "èƒŒå½±"],
        camera_angle: ["å¹³è§†", "ä½è§’åº¦ä»°è§†", "é«˜è§’åº¦ä¿¯è§†", "è·å…°è§’å€¾æ–œ"],
        connectors: ["æ‰‹ç»˜ç®­å¤´æˆ–å¼•å¯¼çº¿", "è™šçº¿è¿æ¥", "å…‰æ•ˆæŒ‡å¼•", "æœºæ¢°è‡‚è¿æ¥"],
        texture_zoom: ["å‡Œä¹±æ„Ÿä¸ç§å¤„æ±—æ¸", "çš®é©çº¹ç†ä¸ç£¨æŸ", "é‡‘å±å…‰æ³½ä¸é”ˆè¿¹", "ä¸ç»¸å…‰æ³½"],
        special_view: ["è¢«è¸©åœ¨è„šä¸‹çš„ä»°è§†è§†è§’", "ä¸Šå¸è§†è§’ä¿¯ç°", "é±¼çœ¼é•œå¤´ç‰¹å†™", "ç›‘æ§æ‘„åƒå¤´è§†è§’"],
        art_style: ["é«˜è´¨é‡çš„2D æ’ç”»é£æ ¼", "å‰åœåŠ›åŠ¨ç”»é£æ ¼", "åšæ¶‚æ²¹ç”»é£æ ¼", "èµ›åšæœ‹å…‹éœ“è™¹é£æ ¼", "é»‘ç™½æ¼«ç”»é£æ ¼"],
        background_style: ["æ¼«ç”»ç½‘æ ¼ç¬”è®°æœ¬", "çº¯è‰²æç®€èƒŒæ™¯", "èµ›åšæœ‹å…‹éœ“è™¹è¡—é“", "åºŸå¼ƒå·¥å‚å†…éƒ¨"],
        lens_param: ["85mm äººåƒé•œå¤´", "35mm äººæ–‡å¹¿è§’", "200mm é•¿ç„¦å‹ç¼©", "å¾®è·é•œå¤´"],
        lighting: ["è‡ªç„¶å…‰", "èµ›åšéœ“è™¹å…‰", "ä¼¦å‹ƒæœ—å…‰", "è¾¹ç¼˜å…‰(Rim Light)", "é¡¶å…‰"],
        
        // Items
        underwear_style: ["æˆå¥—çš„è•¾ä¸å†…è¡£è£¤", "è¿åŠ¨å†…è¡£", "æ£‰è´¨ç®€çº¦æ¬¾", "ç»‘å¸¦é£æ ¼"],
        clothing: ["æœºèƒ½é£å¤–å¥—", "ä¸ç»¸é•¿è£™", "æˆ˜æ–—è£…ç”²", "JKåˆ¶æœ", "æ——è¢"],
        clothing_male: ["è¥¿è£…", "å«è¡£", "æˆ˜æœ¯èƒŒå¿ƒ"],
        clothing_female: ["è¿è¡£è£™", "çŸ­è£™", "ç´§èº«è¡£"],
        bag_content: ["æ—¥å¸¸é€šå‹¤åŒ…æˆ–æ‰‹æ‹¿åŒ…", "æˆ˜æœ¯èƒŒåŒ…", "é­”æ³•è¯å‰‚è¢‹", "æ•£è½çš„å£çº¢ä¸æ‰‹æœº"],
        cosmetics: ["å¸¸ç”¨çš„åŒ–å¦†å“ç»„åˆ", "æˆ˜åœ°æ€¥æ•‘åŒ…", "é­”æ³•ç¬¦æ–‡ç»˜åˆ¶å·¥å…·"],
        private_items: ["éœ‡åŠ¨æ£’ä¸é¡¹åœˆ", "æ—¥è®°æœ¬ä¸æ—§ç…§ç‰‡", "æŠ¤èº«ç¬¦ä¸æ°´æ™¶", "æ‰‹é“ä¸é’¥åŒ™"],
        fashion_deconstruct: ["é¢æ–™è‰²å¡", "è®¾è®¡è‰å›¾", "ç‰ˆå‹æ‹†è§£"],
        toy_companion: ["æ³°è¿ªç†Š", "æœºæ¢°ç‹—", "å·«æ¯’å¨ƒå¨ƒ"],
        sticker_core: ["çˆ±å¿ƒè´´çº¸", "åˆ›å¯è´´", "è­¦å‘Šæ ‡è¯†"],
        sticker_decor: ["æ˜Ÿæ˜Ÿ", "èŠ±ç“£", "è¡€è¿¹"],
        
        // Location
        background_scene: ["å……æ»¡ç”Ÿæ´»æ°”æ¯çš„å§å®¤", "ä¸‹é›¨çš„è¡—é“", "é­”æ³•å­¦é™¢å›¾ä¹¦é¦†", "å¤ªç©ºèˆ±"]
    };

    // å˜é‡åˆ†ç»„é…ç½® (åŒæ­¥åŸç«™åˆ†ç±»)
    const VAR_GROUPS = {
        character: { label: "äººç‰© (CHARACTER)", keys: ["role", "subject", "character_companion", "expressions"], color: "#3b82f6" },
        action: { label: "åŠ¨ä½œ (ACTION)", keys: ["grid_pose", "action_detail", "action_pose"], color: "#10b981" },
        visuals: { label: "ç”»é¢ (VISUALS)", keys: ["layout_focus", "camera_angle", "connectors", "texture_zoom", "special_view", "art_style", "background_style", "lens_param", "lighting"], color: "#8b5cf6" },
        item: { label: "ç‰©å“ (ITEM)", keys: ["underwear_style", "clothing", "clothing_male", "clothing_female", "bag_content", "cosmetics", "private_items", "fashion_deconstruct", "toy_companion", "sticker_core", "sticker_decor"], color: "#f59e0b" },
        location: { label: "åœ°ç‚¹ (LOCATION)", keys: ["background_scene"], color: "#ef4444" },
        other: { label: "å…¶ä»–å˜é‡", keys: [], color: "#6b7280" }
    };

    // 2. çŠ¶æ€ç®¡ç†
    let state = {
        templates: JSON.parse(localStorage.getItem('pf_templates')) || DEFAULT_TEMPLATES,
        options: JSON.parse(localStorage.getItem('pf_options')) || DEFAULT_OPTIONS,
        activeId: localStorage.getItem('pf_active_id') || 't1',
        values: JSON.parse(localStorage.getItem('pf_values')) || {},
        activeConfigKey: 'role'
    };

    // 3. è¾…åŠ©å‡½æ•°
    function saveState() {
        localStorage.setItem('pf_templates', JSON.stringify(state.templates));
        localStorage.setItem('pf_options', JSON.stringify(state.options));
        localStorage.setItem('pf_active_id', state.activeId);
        localStorage.setItem('pf_values', JSON.stringify(state.values));
    }

    function getActiveTemplate() {
        return state.templates.find(t => t.id === state.activeId) || state.templates[0] || {id:'err', content:''};
    }

    function getVariables(content) {
        const regex = /\{\{([^}]+)\}\}/g;
        const found = new Set();
        let m;
        while ((m = regex.exec(content)) !== null) found.add(m[1].trim());
        return Array.from(found);
    }

    function generateText(html = false) {
        const tpl = getActiveTemplate();
        const vars = getVariables(tpl.content);
        let text = tpl.content;
        
        if (html) {
            const parts = text.split(/(\{\{[^}]+\}\})/g);
            return parts.map(part => {
                if (part.startsWith('{{') && part.endsWith('}}')) {
                    const key = part.slice(2, -2).trim();
                    const val = state.values[key];
                    const cls = val ? 'hl-filled' : 'hl-empty';
                    return `<span class="hl-var ${cls}">${val || part}</span>`;
                }
                return part;
            }).join('');
        } else {
            vars.forEach(v => {
                text = text.split(`{{${v}}}`).join(state.values[v] || `{{${v}}`);
            });
            return text;
        }
    }

    // 4. æ¸²æŸ“é€»è¾‘
    function render() {
        renderSidebar();
        renderInputs();
        renderPreview();
        renderConfig();
        renderCodeEditor();
    }

    function renderSidebar() {
        const list = document.getElementById('template-list');
        list.innerHTML = state.templates.map(t => `
            <div class="template-item ${t.id === state.activeId ? 'active' : ''}" onclick="selectTemplate('${t.id}')">
                <div class="template-icon">${t.icon || 'ğŸ“„'}</div>
                <div class="template-info">
                    <div class="template-title">${t.title}</div>
                    <div class="template-desc">${t.content.substring(0, 30)}...</div>
                </div>
            </div>
        `).join('');
    }

    function renderInputs() {
        const tpl = getActiveTemplate();
        const vars = getVariables(tpl.content);
        const container = document.getElementById('input-container');
        const emptyState = document.getElementById('empty-state');

        if (vars.length === 0) {
            container.innerHTML = '';
            emptyState.style.display = 'block';
            return;
        }
        emptyState.style.display = 'none';

        // åˆ†ç»„é€»è¾‘
        const groups = { other: [] };
        Object.keys(VAR_GROUPS).forEach(k => groups[k] = []);
        vars.forEach(v => {
            let matched = false;
            for (const [key, cfg] of Object.entries(VAR_GROUPS)) {
                if (cfg.keys.includes(v)) { groups[key].push(v); matched = true; break; }
            }
            if (!matched) groups.other.push(v);
        });

        // ç”Ÿæˆ HTML
        let html = '';
        Object.entries(groups).forEach(([key, list]) => {
            if (list.length === 0) return;
            const cfg = VAR_GROUPS[key] || VAR_GROUPS.other;
            html += `<div class="var-group"><div class="var-group-title" style="color:${cfg.color}">
                <span style="display:inline-block;width:6px;height:6px;border-radius:50%;background:${cfg.color}"></span>
                ${cfg.label}
            </div>`;
            
            list.forEach(v => {
                const val = state.values[v] || '';
                html += `
                    <div class="var-input-card" style="border-left: 3px solid ${cfg.color}">
                        <div class="var-label">
                            <span>${v}</span>
                            ${val ? `<span style="color:#10b981">âœ“</span>` : ''}
                        </div>
                        <input class="var-input" value="${val}" oninput="updateValue('${v}', this.value)" placeholder="ç‚¹å‡»è¾“å…¥æˆ–é€‰æ‹©...">
                        <div class="var-select-btn" onclick="toggleDropdown('${v}', this)">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
                        </div>
                        <div class="dropdown-menu" id="dropdown-${v}">
                            ${(state.options[v] || []).map(opt => 
                                `<div class="dropdown-item" onclick="selectOption('${v}', '${opt}')">${opt}</div>`
                            ).join('') || '<div style="padding:10px;color:#ccc;text-align:center;font-size:12px;">æš‚æ— é¢„è®¾é€‰é¡¹</div>'}
                        </div>
                    </div>
                `;
            });
            html += `</div>`;
        });
        
        if (container.dataset.tplId !== tpl.id) {
            container.innerHTML = html;
            container.dataset.tplId = tpl.id;
        }
    }

    function renderPreview() {
        const html = generateText(true);
        document.getElementById('preview-card').innerHTML = html;
        document.getElementById('mobile-preview-text').innerHTML = html;
    }

    function renderCodeEditor() {
        const tpl = getActiveTemplate();
        const titleInput = document.getElementById('template-title-input');
        const contentInput = document.getElementById('template-content-input');
        if (titleInput.dataset.tplId !== tpl.id) {
            titleInput.value = tpl.title;
            contentInput.value = tpl.content;
            titleInput.dataset.tplId = tpl.id;
        }
    }

    function renderConfig() {
        const keysContainer = document.getElementById('config-keys');
        const listContainer = document.getElementById('option-list');
        const currentKeyLabel = document.getElementById('current-config-key');
        
        // æ¸²æŸ“ Keys
        const keys = Object.keys(state.options);
        if (!keys.includes(state.activeConfigKey) && keys.length > 0) state.activeConfigKey = keys[0];

        keysContainer.innerHTML = keys.map(k => `
            <button onclick="setConfigKey('${k}')" style="padding:4px 8px;border-radius:12px;font-size:12px;border:1px solid var(--border);background:${k === state.activeConfigKey ? '#1f2937' : 'white'};color:${k === state.activeConfigKey ? 'white' : '#374151'};margin-bottom:4px;">${k}</button>
        `).join('');

        // æ¸²æŸ“ Options
        currentKeyLabel.innerText = state.activeConfigKey;
        const opts = state.options[state.activeConfigKey] || [];
        listContainer.innerHTML = opts.map((o, idx) => `
            <div style="display:flex;justify-content:space-between;align-items:center;padding:8px;border-bottom:1px solid #f3f4f6;font-size:13px;">
                <span style="flex:1;word-break:break-all;margin-right:8px;">${o}</span>
                <button style="color:#ef4444;padding:4px;" onclick="deleteOption('${state.activeConfigKey}', ${idx})">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>
                </button>
            </div>
        `).join('');
    }

    // 5. äº¤äº’åŠ¨ä½œ
    window.selectTemplate = (id) => {
        state.activeId = id;
        saveState();
        render(); 
        document.getElementById('input-container').dataset.tplId = '';
        renderInputs();
        
        // äº¤äº’ä¼˜åŒ–ï¼šç‚¹å‡»æ¨¡ç‰ˆåè‡ªåŠ¨è·³è½¬åˆ°å¡«ç©ºåŒº
        if (window.innerWidth < 1024) {
            // ç§»åŠ¨ç«¯ï¼šåˆ‡æ¢åˆ°åº•éƒ¨ç¬¬äºŒä¸ªTab (Fill)
            openPanel('main');
        } else {
            // PCç«¯ï¼šè§†è§‰æç¤ºç”¨æˆ·å»å³ä¾§æ“ä½œ (å¯é€‰ï¼šé«˜äº®è¾“å…¥æ¡†å®¹å™¨)
            const editor = document.getElementById('view-fill');
            editor.animate([{ opacity: 0.5 }, { opacity: 1 }], { duration: 300 });
        }
    };

    window.createNewTemplate = () => {
        const id = 't' + Date.now();
        state.templates.push({ id, title: 'æœªå‘½åæ¨¡ç‰ˆ', icon: 'ğŸ“', content: 'è¾“å…¥ Prompt å†…å®¹ï¼Œä½¿ç”¨ {{å˜é‡å}} æ¥åˆ›å»ºå¡«ç©ºä½...' });
        selectTemplate(id);
    };

    window.deleteTemplate = (e, id) => {
        e.stopPropagation();
        if (state.templates.length <= 1) return alert('è‡³å°‘ä¿ç•™ä¸€ä¸ªæ¨¡ç‰ˆ');
        if (confirm('ç¡®å®šåˆ é™¤å—ï¼Ÿ')) {
            state.templates = state.templates.filter(t => t.id !== id);
            if (state.activeId === id) state.activeId = state.templates[0].id;
            saveState();
            render();
            document.getElementById('input-container').dataset.tplId = ''; // Force refresh
            renderInputs();
        }
    };

    window.updateValue = (key, val) => {
        state.values[key] = val;
        saveState();
        renderPreview(); // åªæ›´æ–°é¢„è§ˆ
    };

    window.toggleDropdown = (key, btn) => {
        const menu = document.getElementById(`dropdown-${key}`);
        const isVisible = menu.style.display === 'block';
        document.querySelectorAll('.dropdown-menu').forEach(el => el.style.display = 'none');
        if (!isVisible) menu.style.display = 'block';
    };

    window.selectOption = (key, val) => {
        state.values[key] = val;
        saveState();
        document.getElementById('input-container').dataset.tplId = ''; 
        renderInputs(); 
        renderPreview();
    };

    document.addEventListener('click', (e) => {
        if (!e.target.closest('.var-input-card')) {
            document.querySelectorAll('.dropdown-menu').forEach(el => el.style.display = 'none');
        }
    });

    window.switchMode = (mode) => {
        document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(`btn-mode-${mode}`).classList.add('active');
        document.getElementById('view-fill').style.display = mode === 'fill' ? 'flex' : 'none';
        document.getElementById('view-code').style.display = mode === 'code' ? 'flex' : 'none';
        if (mode === 'code') renderCodeEditor();
    };

    document.getElementById('template-title-input').addEventListener('input', (e) => {
        const tpl = state.templates.find(t => t.id === state.activeId);
        if (tpl) { tpl.title = e.target.value; saveState(); renderSidebar(); }
    });
    document.getElementById('template-content-input').addEventListener('input', (e) => {
        const tpl = state.templates.find(t => t.id === state.activeId);
        if (tpl) { 
            tpl.content = e.target.value; 
            saveState(); 
            document.getElementById('input-container').dataset.tplId = ''; 
        }
    });

    window.setConfigKey = (key) => { state.activeConfigKey = key; renderConfig(); };
    window.addOption = () => {
        const input = document.getElementById('new-option-input');
        const val = input.value.trim();
        if (val) {
            if (!state.options[state.activeConfigKey]) state.options[state.activeConfigKey] = [];
            state.options[state.activeConfigKey].push(val);
            input.value = '';
            saveState();
            renderConfig();
        }
    };
    window.deleteOption = (key, idx) => {
        state.options[key].splice(idx, 1);
        saveState();
        renderConfig();
    };

    window.copyResult = () => {
        const text = generateText();
        navigator.clipboard.writeText(text).then(() => alert('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿'));
    };
    window.exportImage = () => {
        const el = document.getElementById('preview-card');
        html2canvas(el, { scale: 2 }).then(canvas => {
            const link = document.createElement('a');
            link.download = 'prompt.png';
            link.href = canvas.toDataURL();
            link.click();
        }).catch(() => alert('ç”Ÿæˆå›¾ç‰‡å¤±è´¥'));
    };

    window.openPanel = (panelName) => {
        document.getElementById('sidebar').classList.remove('open');
        document.getElementById('config-panel').classList.remove('open');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        
        if (panelName === 'sidebar') {
            document.getElementById('sidebar').classList.add('open');
            document.getElementById('nav-templates').classList.add('active');
        } else if (panelName === 'config') {
            document.getElementById('config-panel').classList.add('open');
            document.getElementById('nav-config').classList.add('active');
        } else {
            document.getElementById('nav-fill').classList.add('active');
        }
    };
    window.closeAllPanels = () => openPanel('main');
    window.toggleConfig = () => {
        const panel = document.getElementById('config-panel');
        // PCç«¯é…ç½®é¢æ¿åˆ‡æ¢ (é€šè¿‡ transform)
        // é»˜è®¤ä¸º relative/transform:noneï¼Œä½†åœ¨ <1024px æ—¶æ˜¯ fixed
        // æˆ‘ä»¬è¿™é‡Œä¸º PC å¢åŠ ä¸€ä¸ªæ˜¾å¼çš„æ˜¾ç¤º/éšè—ç±»
        if (window.innerWidth >= 1024) {
            // PCç«¯ç®€å•æç¤º
            alert("è¯åº“é…ç½®é¢æ¿å·²åœ¨å³ä¾§æ˜¾ç¤º");
        } else {
            // ç§»åŠ¨ç«¯é€»è¾‘
            openPanel('config');
        }
    };

    // åˆå§‹åŒ–
    render();

</script>
</body>
</html>